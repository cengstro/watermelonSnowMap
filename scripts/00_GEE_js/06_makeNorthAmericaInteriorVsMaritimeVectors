/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var coastalAK = /* color: #ffc82d */ee.Geometry.Polygon(
        [[[-136.8929472694729, 58.18099842714045],
          [-135.65169661446694, 58.95121095072855],
          [-136.18818482824994, 59.07007413305467],
          [-136.77036613739486, 59.09475514977159],
          [-137.3433867225979, 58.82385084954042],
          [-137.4917021522854, 58.85795787246118],
          [-137.6661952552788, 58.90205105232083],
          [-137.7266200599663, 59.0803350611675],
          [-138.0836757240288, 59.453690248923984],
          [-138.6989100990288, 59.58743209793608],
          [-139.2756923255913, 59.98273687949982],
          [-139.90413438204118, 60.109300434715834],
          [-140.26668321016618, 60.183130088861496],
          [-140.65120469454118, 60.25679411420828],
          [-141.29939805391618, 60.297647096763],
          [-142.43648301485368, 60.47408790844683],
          [-142.96382676485368, 60.57409706926957],
          [-143.39229356172868, 60.54169550151211],
          [-144.56233750704118, 60.51196553714786],
          [-144.96333848360368, 60.4144764757817],
          [-145.00179063204118, 60.50114787219841],
          [-145.11714707735368, 60.58219238969221],
          [-145.32588731172868, 60.79195993790926],
          [-146.25972520235368, 60.845526411064],
          [-146.41353379610368, 61.21798803554729],
          [-147.58907090547868, 61.405212328596534],
          [-147.84724961641618, 61.178290417083275],
          [-148.58882676485368, 60.540181321278844],
          [-149.18208848360368, 60.09681372794787],
          [-149.42747170325103, 60.05339972437561],
          [-149.93465196016618, 59.93209120737652],
          [-146.12665130566623, 60.517868343810704],
          [-145.4283558774008, 60.38750764005024],
          [-143.8620895789489, 60.217265112736946],
          [-139.6363040218908, 59.96275085980181]]]),
    southAKRange = /* color: #00ffff */ee.Geometry.Polygon(
        [[[-144.48438578734812, 63.084270876198474],
          [-145.47864848266062, 63.33926992461883],
          [-145.72584086547312, 63.36637015863306],
          [-145.94556742797312, 63.3294089594145],
          [-146.61024027953562, 63.361444743226],
          [-146.78602152953562, 63.5284359465839],
          [-147.23646098266062, 63.56024996406028],
          [-147.87366801391062, 63.45979278612326],
          [-149.04371195922312, 63.38114134037989],
          [-149.78528910766062, 63.289931291405004],
          [-151.5485947717231, 62.83955696297645],
          [-152.1473496545356, 62.59026010185804],
          [-151.6529648889106, 62.48639899127479]]]),
    bc_coast = /* color: #bf04c2 */ee.Geometry.Polygon(
        [[[-128.41549542595706, 54.04686611636117],
          [-128.35134439128632, 53.58280104208666],
          [-128.05765014973977, 53.16013550020184],
          [-125.72234601561978, 51.079056286416744],
          [-123.80801906372545, 50.30268058572201],
          [-123.53815346175342, 49.84605658777989],
          [-122.92330756607011, 49.58591190866412],
          [-122.73104682388261, 49.78848144237328],
          [-123.86572067215174, 50.61140988380613],
          [-124.61828414871424, 51.15206106273204],
          [-125.47521774246424, 51.21748137854896],
          [-125.56860153152674, 51.16584147754493],
          [-125.70583855249221, 51.22445500648146],
          [-125.81030075027674, 51.33774951640014],
          [-125.9541424564258, 51.53505448489942],
          [-126.08827397452617, 51.65307508483159],
          [-126.46180913077617, 51.982454140941506],
          [-126.60463139640117, 52.39331179319839],
          [-127.02700330915623, 52.598438722211974],
          [-127.55434705915623, 52.94406551936466],
          [-127.71914198103123, 52.993689279939495],
          [-127.74111463728123, 53.165277526599404],
          [-127.88393690290626, 53.2343790172796],
          [-128.0068551319338, 53.74937018011981],
          [-128.3309518116213, 54.17916440726702],
          [-129.1109811084963, 54.21451306177117],
          [-129.5449410694338, 54.50341239560439],
          [-129.5339547413088, 54.8242968362988],
          [-129.65068447763693, 54.992456893846196],
          [-129.6952809157684, 55.00931963850512],
          [-129.6877633350588, 55.14579093801998],
          [-129.64656460459005, 55.44758390187365],
          [-129.8031197803713, 55.73780946230686],
          [-130.1931344288088, 55.76872266999194],
          [-130.4403268116213, 56.07037751279761],
          [-130.8358346241213, 56.26916199007214],
          [-131.44390782092202, 56.38291599155037],
          [-131.73504551623452, 56.61032645097633],
          [-132.54803379748452, 56.93540733107119],
          [-132.82818516467202, 57.07599977740073],
          [-132.88860996935952, 57.275501475714776],
          [-133.06988438342202, 57.67715746086304],
          [-133.32806309435952, 57.96094193097308],
          [-133.73455723498452, 57.9463684282192],
          [-133.67413243029702, 58.248279967361796],
          [-133.99273594592202, 58.493141010371566],
          [-134.21246250842202, 58.676387749609134],
          [-135.03094395373452, 59.22601440622749],
          [-135.12982090685952, 59.385842474642644],
          [-135.34405430529702, 59.58665893931263],
          [-135.39541916134584, 59.43717827651674],
          [-135.18475254748452, 58.88423420811219],
          [-135.11883457873452, 58.79327655832028],
          [-134.93203214498874, 58.99814263802784],
          [-132.92478360220414, 57.07295045666468],
          [-131.77592328015405, 56.44076731108904],
          [-130.61752444226073, 55.91415140635941],
          [-129.9986952276989, 54.71371799387104],
          [-129.17674029369002, 54.008135984367385]]]),
    geometry = 
    /* color: #d63000 */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-144.4310081916391, 63.27508261476036],
          [-144.4310081916391, 63.212020718967786],
          [-144.23462757640473, 63.212020718967786],
          [-144.23462757640473, 63.27508261476036]]], null, false),
    geometry2 = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.LinearRing(
        [[-144.23531422191255, 63.275700187384565],
         [-144.42963490062348, 63.27539140272509],
         [-144.4310081916391, 63.21233018175851],
         [-144.23531422191255, 63.212020718967786],
         [-144.23531422191255, 63.275700187384565]]),
    geometry3 = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.Geometry.LineString(
        [[-144.1453636603891, 63.25824867113119],
         [-144.07601246410005, 63.258557639272766],
         [-144.12133106761567, 63.1551782269865],
         [-144.09729847484223, 63.147735534472794],
         [-144.10897144847505, 63.14463384886749]]),
    eraser = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.MultiPolygon(
        [[[[-137.45300443303282, 58.92271665309319],
           [-137.57385404240782, 58.90569923839465],
           [-137.12890775334532, 58.523454114104254],
           [-136.27197415959532, 58.17757174356491],
           [-132.8077776664237, 56.12759872099888],
           [-131.0279925101737, 53.560330783979026],
           [-127.74046165585585, 50.59779748699042],
           [-124.22483665585585, 48.836431301088936],
           [-122.26927024960585, 47.931711553944375],
           [-121.19261009335585, 48.720596525646414],
           [-121.23314525457975, 48.96851354633047],
           [-121.6149201569235, 49.05138527809339],
           [-122.58446361395475, 49.13411910152926],
           [-122.69982005926725, 49.47260109050595],
           [-123.40908406398606, 50.014007965540024],
           [-123.96938679836106, 50.5615222232942],
           [-125.71621297023606, 51.1716832573422],
           [-126.48337790758406, 51.98353743440211],
           [-127.61684773586106, 52.908159424576915],
           [-128.16616414211106, 53.55263125723514],
           [-128.49575398586106, 54.1874349717226],
           [-128.97915242336106, 54.17457599060867],
           [-129.59438679836106, 54.45655086968072],
           [-130.08123556108947, 55.48491299397762],
           [-131.28423849077697, 56.23708184090774],
           [-132.36639181108947, 56.87883905349982],
           [-132.97063985796447, 57.130118139132236],
           [-133.3477614266602, 57.83372282361992],
           [-133.8860915047852, 58.107573268908695],
           [-134.4354079110352, 58.597540243776955],
           [-134.9407790047852, 59.00727364351682],
           [-135.2703688485352, 59.114592364453124],
           [-135.7647536141602, 59.035547930741714],
           [-136.3690016610352, 59.080738466836486],
           [-136.7864821297852, 59.035547930741714],
           [-137.07592668780242, 59.06453392646721],
           [-137.26269426592742, 58.95139267901599],
           [-137.3798615373755, 58.922914895461325]]],
         [[[-147.43715907988295, 60.63803608537984],
           [-149.19604953874588, 60.074818257847724],
           [-149.33886719258325, 60.13094645111177],
           [-149.418516096268, 60.128210845656234],
           [-149.91288688700453, 59.88795277738304],
           [-150.06491234397322, 59.861373871100774],
           [-150.20223791937752, 59.802018769265075],
           [-150.35054791392318, 59.76746605312768],
           [-150.5016062776066, 59.790971145400306],
           [-150.82294629293202, 59.86275408387014],
           [-151.37774037034427, 59.719035518147784],
           [-152.06436739159338, 59.49114159790543],
           [-152.12479284747792, 59.19706222893038],
           [-151.7567622466636, 59.10693012988563],
           [-148.5213814897264, 59.37940590355844],
           [-145.016846093843, 59.766082836672034],
           [-141.78146925337606, 59.76055221987665],
           [-138.95498510047005, 59.086390656465575],
           [-137.02938558846114, 58.06825906124664],
           [-136.32628108400988, 58.175595273968256],
           [-136.13952129804193, 58.441082477374295],
           [-136.72200591317514, 58.86510056384107],
           [-137.67778968321633, 58.93319563949708],
           [-138.6675739315267, 59.48274087376212],
           [-138.96419807554793, 59.76052398016761],
           [-138.9230026577608, 59.81028152171966],
           [-138.99166426870613, 59.92334073915731],
           [-139.80232168487052, 60.120957408279466],
           [-140.9997955439893, 60.18929590898687],
           [-142.0214932393248, 60.252042386683634],
           [-143.746294310109, 60.360881701457096],
           [-144.75151255565694, 60.48018766605332],
           [-144.88609244799434, 60.47071349364776],
           [-144.93552873107458, 60.49642270595338],
           [-145.10031771933507, 60.589617195955576],
           [-146.18999510628197, 60.897211392196596],
           [-146.2998546841414, 61.05976739333804],
           [-146.2531655187382, 61.09297559071842],
           [-146.27238952488102, 61.18974395516819],
           [-146.6623917062446, 61.23603485039924],
           [-147.38923476172147, 61.34948939983808],
           [-147.84515323957666, 61.23867876864743],
           [-148.4169334736477, 60.80309284273864]]],
         [[[-149.54696007655363, 62.13073143123982],
           [-146.97066613124113, 62.23838770556517],
           [-145.01509972499113, 62.135866617986245],
           [-144.10872765467863, 62.79857942501978],
           [-144.09224816249113, 63.14803213054832],
           [-145.33370324061613, 63.167874863997156],
           [-145.57540245936613, 63.375405240995875],
           [-145.64681359217863, 63.31132910722303],
           [-145.77315636561613, 63.33352546280933],
           [-145.96541710780363, 63.192659190462344],
           [-146.73446007655363, 63.41230734713793],
           [-147.95943566249113, 63.50312986269829],
           [-148.03084679530363, 63.41722404361405],
           [-148.12972374842863, 63.449162026655074],
           [-148.76755921083884, 63.424746551664526],
           [-148.98728577333884, 63.41245645503343],
           [-152.14585510927634, 62.59716363198426],
           [-152.37107483583884, 62.495863563528985],
           [-151.06370178896384, 61.83674077013079],
           [-150.52537171083884, 61.82377456070653]]]]),
    n_denali = 
    /* color: #00ffff */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-143.8343830971009, 63.53467231269855],
          [-144.8890705971009, 63.86567140762534],
          [-148.4266682533509, 63.95264263565869],
          [-153.0409260658509, 63.01094000180943],
          [-152.0521565346009, 62.48778752234526],
          [-148.16599675585405, 62.90356727170157],
          [-144.2518635658509, 63.03087646543786]]]),
    interior_chugatch = 
    /* color: #bf04c2 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-136.0890217689759, 59.12897149414481],
          [-136.0187217780305, 59.2858907828121],
          [-136.00841240686364, 59.354506613256675],
          [-135.9759651619349, 59.386765132566666],
          [-136.39069904865366, 59.52216489955365],
          [-136.91818732580575, 60.04472124057899],
          [-140.05455612705708, 61.287601332547894],
          [-141.39488815830708, 60.99063974510285],
          [-142.60338425205708, 61.21362260597895],
          [-144.69078659580708, 61.3297967632812],
          [-146.66832565830708, 61.96627665903543],
          [-147.43736862705708, 61.89390228565506],
          [-149.15123581455708, 61.58177941201375],
          [-149.23912643955708, 61.150073585970254],
          [-151.41441940830708, 59.63049032405482],
          [-151.10680222080708, 59.619379667021065],
          [-150.38381320892967, 59.67089213616923],
          [-149.87633347080708, 59.90430984881392],
          [-149.55752780078348, 60.05218258310489],
          [-149.42608451778165, 60.131743697585534],
          [-149.1495665387168, 60.10340799099039],
          [-148.6741027938995, 60.720409608328666],
          [-148.6433041836791, 60.77651832706062],
          [-148.7263826064764, 60.78058770544336],
          [-148.58692327547953, 60.84167573085805],
          [-148.43951929261738, 61.04819882442956],
          [-147.68433315760768, 61.33049959611349],
          [-146.25882458415074, 61.14295620644522],
          [-146.23917622730463, 60.86666373960221],
          [-144.91371944258327, 60.478468811991036],
          [-142.5675976722906, 60.453055115195035],
          [-140.15050138437124, 60.18143152912925],
          [-139.43494288324553, 60.02978987452848],
          [-138.72384598193517, 59.659471978389],
          [-137.68150925205708, 58.82107882630922],
          [-137.31522847316305, 58.939079012595045],
          [-137.0565778160003, 59.067661982079386],
          [-136.25930682606727, 59.152544642097986]]]),
    bc_interior = 
    /* color: #ff0000 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-132.86693785592806, 57.54717836166705],
          [-132.89250705258848, 57.1093578702514],
          [-132.06868867730714, 56.849035005249924],
          [-131.46778985088343, 56.39889348262401],
          [-129.60510620174145, 55.02219857384433],
          [-129.56946210474788, 54.5511263370566],
          [-128.47910296529534, 53.605970887234676],
          [-127.42775032511375, 52.64266934261022],
          [-126.74131495422469, 52.29243906628684],
          [-126.07033002360726, 51.62867304185764],
          [-125.66216112573566, 51.19734166301763],
          [-124.31511103441446, 50.9281230800639],
          [-123.58083864378938, 50.03543033684302],
          [-122.9684933830448, 49.71673351763324],
          [-122.45582807048226, 49.329148846202884],
          [-121.08253705485726, 49.536349076595144],
          [-123.19160218474552, 51.59660876062489],
          [-128.89581548536867, 56.785927844929546],
          [-129.11554204786867, 57.40067364936111],
          [-131.13702642286867, 57.71890818946669],
          [-134.63067876661867, 59.93583610767563],
          [-136.82794439161867, 60.487080251793586],
          [-135.58794283079905, 59.75694993712946],
          [-135.23638033079905, 59.49586247410121],
          [-135.10867072307076, 59.16882621314286],
          [-134.42316217472379, 58.770701572449575],
          [-133.9462770664201, 58.46304579676582],
          [-133.63167050535083, 58.016121663578446]]]),
    shed8 = ee.FeatureCollection("WWF/HydroSHEDS/v1/Basins/hybas_8"),
    regions = ee.FeatureCollection("projects/ee-caseyengstrom/assets/globalSnowAlgae/glacierRegionsV14");
/***** End of imports. If edited, may not auto-convert in the playground. *****/
/*
Define east and west sides of Alaska Range, and Pacific Coast Ranges using WWF HydroSHEDS

*/






// bc linestring --------------
var roi = bc_coast
var fc =shed8.filterBounds(roi)
//rewrite w evaluate
// function featuresToLineString(fc){

var geom = fc.geometry().dissolve().simplify(1000)//.aside(Map.addLayer, {}, "geom1")
var geomPlus = geom.union(roi) // use a bridge to unite seperate features

var geomList = geomPlus.geometries()
// print('geomList',geomList)
var geomListSize = geomList.size().subtract(1) // hack, largest geom will take longest
// print(geomListSize)
var biggestGeomCoords = ee.Geometry(geomList.get(geomListSize)).coordinates().get(0)
// print(biggestGeom)
var linestring = ee.Geometry.LineString(biggestGeomCoords.getInfo())
  // Map.addLayer(linestring,{},'LS')
// }
// print(coords)

// var bcPerim = featuresToLineString()
// Map.addLayer(bcPerim)
// print(bcPerim)




var bc_ridgeline = linestring.difference(eraser)
// Map.addLayer(bc_ridgeline)


// get the ak ridgeline ----------------------

var roi2 = coastalAK
var fc2 =shed8.filterBounds(roi2)
//rewrite w evaluate
// function featuresToLineString(fc){

var geom2 = fc2.geometry().dissolve().simplify(1000)//.aside(Map.addLayer,{},"geom2")
var geomPlus2 = geom2.union(roi2) // use a bridge to unite seperate features
// Map.addLayer(geomPlus)
var geomList2 = geomPlus2.geometries()
// print('geomList',geomList2)
var geomListSize2 = geomList2.size().subtract(1) // hack, largest geom will take longest
// print(geomListSize2)
var biggestGeomCoords2 = ee.Geometry(geomList2.get(geomListSize2)).coordinates().get(0)
// print(biggestGeomCoords2)
var linestring2 = ee.Geometry.LineString(biggestGeomCoords2.getInfo())
// print(linestring2)
// Map.addLayer(linestring2)
var ak_ridgeline = linestring2.difference(eraser)
// Map.addLayer(ak_ridgeline)


// get the denali ridgeline ----------------------

var roi3 = southAKRange
var fc3 =shed8.filterBounds(roi3)
//rewrite w evaluate
// function featuresToLineString(fc){

var geom3 = fc3.geometry().dissolve().simplify(1000)//.aside(Map.addLayer,{},"geom3")
var geomPlus3 = geom3.union(roi3) // use a bridge to unite seperate features
// Map.addLayer(geomPlus3)
var geomList3 = geomPlus3.geometries()
// print('geomList',geomList3)
var geomListSize3 = geomList3.size().subtract(1) // hack, largest geom will take longest
// print(geomListSize3)
var biggestGeomCoords3 = ee.Geometry(geomList3.get(geomListSize3)).coordinates().get(0)
// print(biggestGeomCoords3)
var linestring3 = ee.Geometry.LineString(biggestGeomCoords3.getInfo())
// print(linestring3)
// Map.addLayer(linestring3)
var denali_ridgeline = linestring3.difference(eraser)
// Map.addLayer(denali_ridgeline)

var ridges = ee.FeatureCollection([
  ee.Feature(bc_ridgeline,{"name":"bc"}),
  ee.Feature(ak_ridgeline,{"name":"ak"}),
  ee.Feature(denali_ridgeline,{"name":"denali"})
])

// Export.table.toDrive(ridges, "ridge_features", "figs", "ridge_features","KML")

// create dry and wet polygons -----------------------

// bc
var interior_bc = bc_interior.difference(geom, 1000)
var coastal_bc = geom
// chugatch
interior_chugatch = interior_chugatch.difference(geom2, 1000)
var coastal_chugatch = geom2

// denali
var north_denali = n_denali.difference(geom3, 1000)
var south_denali = geom3


// klass is the algae side north to south, then, non algae side N-S
var polys = ee.FeatureCollection([
  ee.Feature(interior_bc,{"name":"bcCoastInterior", "klass":2}),
  ee.Feature(coastal_bc,{"name":"bcCoastMaritime", "klass":5}),
  ee.Feature(interior_chugatch,{"name":"alaskaCoastInterior", "klass":1}),
  ee.Feature(coastal_chugatch,{"name":"alaskaCoastMaritime", "klass":4}),
  ee.Feature(north_denali,{"name":"denaliNorth", "klass":3}),
  ee.Feature(south_denali,{"name":"denaliSouth", "klass":0})
])

Map.addLayer(polys)

Export.table.toAsset(polys, "globalSnowAlgae/northAmericaInteriorVsMaritimeVectors")

// generate image of polys
var asImage = polys.reduceToImage(['klass'],ee.Reducer.first())//.aside(print)
  .rename('region_dummy')
  .aside(Map.addLayer)
  

Export.image.toAsset({image:asImage, description:"coast_v_interior_image",
assetId:"globalSnowAlgae/coast_v_interior_image", scale:1000, maxPixels:900000000})



